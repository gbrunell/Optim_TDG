CREATE CM TDG.COLMAP1
  VALRULES M
  DSTUSESSRC T
  SRCEXTDSN //'1_CA Customers.XF'// 
  DSTEXTDSN //'1_CA Customers.XF'// 
  SRC OPtimfp4.OPTIM.OPTIM_CUSTOMERS DEST OPtimfp4.OPTIM.OPTIM_CUSTOMERS
  ('PROP(SEQ(1000,1))' = CUST_ID, 
   CUSTNAME = CUSTNAME, 
   ADDRESS = ADDRESS, 
   CITY = CITY, 
   STATE = STATE, 
   ZIP = ZIP, 
   EMAIL = EMAIL, 
   CCN = CCN, 
   YTD_SALES = YTD_SALES, 
   SALESMAN_ID = SALESMAN_ID, 
   PHONE_NUMBER = PHONE_NUMBER);

CREATE CM TDG.COLMAP2
  VALRULES M
  DSTUSESSRC T
  SRCEXTDSN //'C:\Optim\Data\Test Data Generation\2_Unmasked Customers.XF'// 
  DSTEXTDSN //'C:\Optim\Data\Test Data Generation\2_Unmasked Customers.XF'// 
  SRC OPtimfp4.OPTIM.OPTIM_CUSTOMERS_STAGE DEST 
  OPtimfp4.OPTIM.OPTIM_CUSTOMERS_TGT
  (CUST_ID = CUST_ID, 
   'HASH_LOOKUP(CUST_ID,OPtimfp4.OPTIM.OPTIM_COMPANY(SEQ, NAME))' = CUSTNAME, 
   'HASH_LOOKUP(CUST_ID,OPtimfp4.OPTIM.OPTIM_US_ADDRESSES(SEQ, ADDRESS1))' = 
   ADDRESS, 
   'HASH_LOOKUP(CUST_ID,OPtimfp4.OPTIM.OPTIM_US_ADDRESSES(SEQ, CITY))' = CITY, 
   'HASH_LOOKUP(CUST_ID,OPtimfp4.OPTIM.OPTIM_US_ADDRESSES(SEQ, STATE))' = STATE, 
   'HASH_LOOKUP(CUST_ID,OPtimfp4.OPTIM.OPTIM_US_ADDRESSES(SEQ, ZIPCODE))' = ZIP, 
   'TRANS EML' = EMAIL, 
   'TRANS CCN' = CCN, 
   YTD_SALES = YTD_SALES, 
   SALESMAN_ID = SALESMAN_ID, 
   PHONE_NUMBER = PHONE_NUMBER);

CREATE CONV TDG.CONVERT1
  SRCXF //'C:\Optim\Data\Test Data Generation\2_Unmasked Customers.XF'// 
  DESTXF //'C:\Optim\Data\Test Data Generation\3_Masked Customers.XF'// CF //'contr'
'ol.CF'// 
  FORCEEDITTM N DELCNTLFILE N TM TDG.TBLMAP2 SHOWCURRENCY N SHOWAGE N 
  FUNCTION_AGING (
    AGETYPE NONE MULTIPLE 1 CALENDAR SAMPLE_US PIVOT 30 INVALIDDATES N 
    SKIPPEDDATES N 
  )
  GLOBAL_AGING (
    AGETYPE NONE MULTIPLE 1 CALENDAR SAMPLE_US PIVOT 30 INVALIDDATES N 
    SKIPPEDDATES N 
  )
  REPORT_OPTION (
    RPTERROR F RPTSUMMARY F RPTINVALID F RPTSKIPPED F 
  )
  CURRENCY_OPTION (
    DEFAULT SAMPLE 
  )
  COMPRESSFILE Y INCL_FILEATTACH Y 
  ;

CREATE EXTR TDG.EXTRACT1
  DESC //'180 California Customers before masking'// 
  XF //'Test Data Generation\1_CA Customers.XF'// 
  LOCALAD (
    SRCQUAL OPtimfp4.OPTIM START OPTIM_CUSTOMERS ADDTBLS N MODCRIT N ADCHGS N 
    USENEW Y PNSSTATE N 
    TABLE (OPTIM_CUSTOMERS ACCESS SUID REF N DAA N UR N PREDOP A VARDELIM : 
      COLFLAG N 
      COLUMN (CUST_ID DISP Y ACCESS U HEADING NC NATIVELOB N EXTRACT Y )
      COLUMN (CUSTNAME DISP Y ACCESS U HEADING NC NATIVELOB N EXTRACT Y )
      COLUMN (ADDRESS DISP Y ACCESS U HEADING NC NATIVELOB N EXTRACT Y )
      COLUMN (CITY DISP Y ACCESS U HEADING NC NATIVELOB N EXTRACT Y )
      COLUMN (STATE DISP Y ACCESS U HEADING NC NATIVELOB N EXTRACT Y  PRED //"='CA'"// 
      )
      COLUMN (ZIP DISP Y ACCESS U HEADING NC NATIVELOB N EXTRACT Y )
      COLUMN (EMAIL DISP Y ACCESS U HEADING NC NATIVELOB N EXTRACT Y )
      COLUMN (CCN DISP Y ACCESS U HEADING NC NATIVELOB N EXTRACT Y )
      COLUMN (YTD_SALES DISP Y ACCESS U HEADING NC NATIVELOB N EXTRACT Y )
      COLUMN (SALESMAN_ID DISP Y ACCESS U HEADING NC NATIVELOB N EXTRACT Y )
      COLUMN (PHONE_NUMBER DISP Y ACCESS U HEADING NC NATIVELOB N EXTRACT Y )
    )
  )
  PNSOVERRIDE N PNSOPT N PNSSTART OPtimfp4.OPTIM.OPTIM_CUSTOMERS
  OPTION B INCLPK Y INCLFK Y INCLIDX Y INCLALIAS Y INCLASSEMBLY Y 
  INCLFUNCTION Y INCLPACKAGE Y INCLPAR_FUNCTION Y INCLPAR_SCHEME Y 
  INCLPROCEDURE Y INCLSEQUENCE Y INCLTRIGGER Y INCLVIEW Y INCLDEFAULT Y 
  INCLRULE Y INCLUDT Y IGNOREUNKNOWN N COMPRESSFILE Y GENSTATISTIC Y 
  PROCESS_FILEATTACH Y ROWLIMIT 0 DBCONNECTIONS 1 OBJQUAL  
  'OPTIMSANDBOX."OPTIM"' ;

CREATE EXTR TDG.EXTRACT2
  DESC //'Extract of unmasked with seq number'// 
  XF //'Test Data Generation\2_Unmasked Customers.XF'// 
  LOCALAD (
    SRCQUAL OPtimfp4.OPTIM START OPTIM_CUSTOMERS_STAGE ADDTBLS N MODCRIT N 
    ADCHGS N USENEW Y PNSSTATE N 
    TABLE (OPTIM_CUSTOMERS_STAGE ACCESS SUID REF N DAA N UR N PREDOP A 
      VARDELIM : COLFLAG N 
    )
  )
  PNSOVERRIDE N PNSOPT N PNSSTART OPtimfp4.OPTIM.OPTIM_CUSTOMERS_STAGE
  OPTION B INCLPK Y INCLFK Y INCLIDX Y INCLALIAS Y INCLASSEMBLY Y 
  INCLFUNCTION Y INCLPACKAGE Y INCLPAR_FUNCTION Y INCLPAR_SCHEME Y 
  INCLPROCEDURE Y INCLSEQUENCE Y INCLTRIGGER Y INCLVIEW Y INCLDEFAULT Y 
  INCLRULE Y INCLUDT Y IGNOREUNKNOWN N COMPRESSFILE Y GENSTATISTIC Y 
  PROCESS_FILEATTACH Y ROWLIMIT 0 DBCONNECTIONS 1 OBJQUAL  
  'OPTIMSANDBOX."OPTIM"' ;

CREATE UPIN TDG.INSERT1
  XF //'Test Data Generation\1_CA Customers.XF'// CF //'Test Data'
' Generation\control.CF'// 
  TM TDG.TBLMAP1
  DISCARDLIMIT 0 COMMITFREQ 200 FORCEEDITTM N LOCKTBLS N UPDINS I 
  DELETEROWS N ALWAYSCALLCREATE N TRIGMODE N CONSMODE N SHOWCURRENCY N 
    SHOWAGE N DELCF N PROCESS_FILEATTACH Y 
  FUNCTION_AGING (
    AGETYPE NONE MULTIPLE 1 CALENDAR SAMPLE_US PIVOT 30 INVALIDDATES N 
    SKIPPEDDATES N 
  )
  GLOBAL_AGING (
    AGETYPE NONE MULTIPLE 1 CALENDAR SAMPLE_US PIVOT 30 INVALIDDATES N 
    SKIPPEDDATES N 
  )
  REPORT_OPTION (
    RPTERROR F RPTSUMMARY F RPTINVALID F RPTSKIPPED F 
  )
  CURRENCY_OPTION (
    DEFAULT SAMPLE 
  )
  TBL (OPTIM_CUSTOMERS_STAGE DELETEROWS N UPDINS N)
  ;

CREATE UPIN TDG.INSERT2
  XF //'Test Data Generation\3_Masked Customers.XF'// CF //'Test Data'
' Generation\control.CF'// 
  LOCALTM (
    SRCQUAL OPtimfp4.OPTIM DESTQUAL OPtimfp4.OPTIM VALRULES M
    (OPTIM_CUSTOMERS_TGT = OPTIM_CUSTOMERS_TGT)
  )
  DISCARDLIMIT 0 COMMITFREQ 200 FORCEEDITTM N LOCKTBLS N UPDINS I 
  DELETEROWS N ALWAYSCALLCREATE N TRIGMODE N CONSMODE N SHOWCURRENCY N 
    SHOWAGE N DELCF N PROCESS_FILEATTACH Y 
  FUNCTION_AGING (
    AGETYPE NONE MULTIPLE 1 CALENDAR SAMPLE_US PIVOT 30 INVALIDDATES N 
    SKIPPEDDATES N 
  )
  GLOBAL_AGING (
    AGETYPE NONE MULTIPLE 1 CALENDAR SAMPLE_US PIVOT 30 INVALIDDATES N 
    SKIPPEDDATES N 
  )
  REPORT_OPTION (
    RPTERROR F RPTSUMMARY F RPTINVALID F RPTSKIPPED F 
  )
  CURRENCY_OPTION (
    DEFAULT SAMPLE 
  )
  TBL (OPTIM_CUSTOMERS_TGT DELETEROWS N UPDINS N)
  ;

CREATE TM TDG.TBLMAP1
  SRCQUAL OPtimfp4.OPTIM DESTQUAL OPtimfp4.OPTIM SRCEXT //'Test Data Generation\1_CA'
' Customers.XF'// SRCTYPE X DESTDB DESTTYPE D VALRULES M
  (OPTIM_CUSTOMERS = OPTIM_CUSTOMERS_STAGE CM TDG.COLMAP1)
;

CREATE TM TDG.TBLMAP2
  SRCQUAL OPtimfp4.OPTIM DESTQUAL OPtimfp4.OPTIM SRCEXT //'C:\Optim\Data\Test Data'
' Generation\2_Unmasked Customers.XF'// SRCTYPE X DESTDB DESTTYPE D 
  VALRULES M
  (OPTIM_CUSTOMERS_STAGE = OPTIM_CUSTOMERS_TGT CM TDG.COLMAP2)
;

